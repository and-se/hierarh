<!DOCTYPE html>
<head>

<meta charset="utf8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{article.header}}</title>

<link rel="stylesheet" type="text/css" href="/static/simple.css" >
<link rel="stylesheet" type="text/css" href="/static/style.css" >


</head>

<body>
    <header>
        <nav>
          <ul class="collections">
              <li><a class="{{'current' if item_type=='cafedra'}}" href="/cafedra">Кафедры</a></li>
              <li><a class="{{'current' if item_type=='episkop'}}" href="/episkop">Епископы</a></li>
          </ul>
        </nav>
    </header>

    <main>
    {% autoescape false %}
    <h1>{{article.header}}</h1>
    {%if article.text %}
    <p>{{article.text}}</p>
    {% endif %}

    <table class="episkops">
    {% for ep in article.episkops %}
    <tr>
        {%if ep is string%}
        <th colspan="3" class="episkops_header">{{ep}}</th>
        {%elif ep.unparsed_data %}
        <td>{{ep.unparsed_data}}</td>
        {% else %}
        <td>{{ep.begin_dating}}</td>
        <td>{{ep.end_dating}}</td>
        <td>
            {%if ep.episkop_id %}
                <a href="/episkop/{{ep.episkop_id}}">{{ep.episkop}}</a>
            {% else %}
                {{ep.who}}
            {% endif %}
        </td>
        {% endif %}
    </tr>
    {% endfor %}
    </table>

    <ul class="notes">
    {%for note in article.notes%}
    <li>
        <p>
            <span class="note_start" id="note_{{note.num}}">{{note.num}}</span>
            {{note.text}}
        </p>
    </li>
    {%endfor%}
    </ul>

    {% endautoescape %}
    </main>
    <script>
        var elements = document.getElementsByClassName("note");

        var go_to_note = function(event) {
            el = document.getElementById("note_" + this.dataset.note)
            if (el) {
                event.preventDefault();
                el.scrollIntoView();
                var back = this;
                el.parentElement.setAttribute('title', "Нажмите на номер ссылки для возврата обратно");

                var go_back = function() {
                    el.parentElement.removeAttribute('title');
                    back.scrollIntoView();
                }

                el.addEventListener('click', go_back, { once: true, capture: false});
            }
        }

        for (var i = 0; i < elements.length; i++) {
            elements[i].addEventListener('click', go_to_note, false);
        }
    </script>
</body>
